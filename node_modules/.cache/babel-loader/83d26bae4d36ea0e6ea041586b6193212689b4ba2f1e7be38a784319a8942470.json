{"ast":null,"code":"import _classCallCheck from \"/Users/chirag_vaid/Desktop/Pesto/team-anil-rao-p8-team-anil-rao/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"/Users/chirag_vaid/Desktop/Pesto/team-anil-rao-p8-team-anil-rao/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport { logger } from '@sentry/utils';\n\n/** Deduplication filter */\nvar Dedupe = /*#__PURE__*/function () {\n  function Dedupe() {\n    _classCallCheck(this, Dedupe);\n    Dedupe.prototype.__init.call(this);\n  }\n  /**\n   * @inheritDoc\n   */\n  _createClass(Dedupe, [{\n    key: \"__init\",\n    value:\n    /**\n     * @inheritDoc\n     */\n    function __init() {\n      this.name = Dedupe.id;\n    }\n\n    /**\n     * @inheritDoc\n     */\n\n    /**\n     * @inheritDoc\n     */\n  }, {\n    key: \"setupOnce\",\n    value: function setupOnce(addGlobalEventProcessor, getCurrentHub) {\n      var eventProcessor = function eventProcessor(currentEvent) {\n        // We want to ignore any non-error type events, e.g. transactions or replays\n        // These should never be deduped, and also not be compared against as _previousEvent.\n        if (currentEvent.type) {\n          return currentEvent;\n        }\n        var self = getCurrentHub().getIntegration(Dedupe);\n        if (self) {\n          // Juuust in case something goes wrong\n          try {\n            if (_shouldDropEvent(currentEvent, self._previousEvent)) {\n              (typeof __SENTRY_DEBUG__ === 'undefined' || __SENTRY_DEBUG__) && logger.warn('Event dropped due to being a duplicate of previously captured event.');\n              return null;\n            }\n          } catch (_oO) {\n            return self._previousEvent = currentEvent;\n          }\n          return self._previousEvent = currentEvent;\n        }\n        return currentEvent;\n      };\n      eventProcessor.id = this.name;\n      addGlobalEventProcessor(eventProcessor);\n    }\n  }], [{\n    key: \"__initStatic\",\n    value: function __initStatic() {\n      this.id = 'Dedupe';\n    }\n  }]);\n  return Dedupe;\n}();\nDedupe.__initStatic();\n\n/** JSDoc */\nfunction _shouldDropEvent(currentEvent, previousEvent) {\n  if (!previousEvent) {\n    return false;\n  }\n  if (_isSameMessageEvent(currentEvent, previousEvent)) {\n    return true;\n  }\n  if (_isSameExceptionEvent(currentEvent, previousEvent)) {\n    return true;\n  }\n  return false;\n}\n\n/** JSDoc */\nfunction _isSameMessageEvent(currentEvent, previousEvent) {\n  var currentMessage = currentEvent.message;\n  var previousMessage = previousEvent.message;\n\n  // If neither event has a message property, they were both exceptions, so bail out\n  if (!currentMessage && !previousMessage) {\n    return false;\n  }\n\n  // If only one event has a stacktrace, but not the other one, they are not the same\n  if (currentMessage && !previousMessage || !currentMessage && previousMessage) {\n    return false;\n  }\n  if (currentMessage !== previousMessage) {\n    return false;\n  }\n  if (!_isSameFingerprint(currentEvent, previousEvent)) {\n    return false;\n  }\n  if (!_isSameStacktrace(currentEvent, previousEvent)) {\n    return false;\n  }\n  return true;\n}\n\n/** JSDoc */\nfunction _isSameExceptionEvent(currentEvent, previousEvent) {\n  var previousException = _getExceptionFromEvent(previousEvent);\n  var currentException = _getExceptionFromEvent(currentEvent);\n  if (!previousException || !currentException) {\n    return false;\n  }\n  if (previousException.type !== currentException.type || previousException.value !== currentException.value) {\n    return false;\n  }\n  if (!_isSameFingerprint(currentEvent, previousEvent)) {\n    return false;\n  }\n  if (!_isSameStacktrace(currentEvent, previousEvent)) {\n    return false;\n  }\n  return true;\n}\n\n/** JSDoc */\nfunction _isSameStacktrace(currentEvent, previousEvent) {\n  var currentFrames = _getFramesFromEvent(currentEvent);\n  var previousFrames = _getFramesFromEvent(previousEvent);\n\n  // If neither event has a stacktrace, they are assumed to be the same\n  if (!currentFrames && !previousFrames) {\n    return true;\n  }\n\n  // If only one event has a stacktrace, but not the other one, they are not the same\n  if (currentFrames && !previousFrames || !currentFrames && previousFrames) {\n    return false;\n  }\n  currentFrames = currentFrames;\n  previousFrames = previousFrames;\n\n  // If number of frames differ, they are not the same\n  if (previousFrames.length !== currentFrames.length) {\n    return false;\n  }\n\n  // Otherwise, compare the two\n  for (var i = 0; i < previousFrames.length; i++) {\n    var frameA = previousFrames[i];\n    var frameB = currentFrames[i];\n    if (frameA.filename !== frameB.filename || frameA.lineno !== frameB.lineno || frameA.colno !== frameB.colno || frameA.function !== frameB.function) {\n      return false;\n    }\n  }\n  return true;\n}\n\n/** JSDoc */\nfunction _isSameFingerprint(currentEvent, previousEvent) {\n  var currentFingerprint = currentEvent.fingerprint;\n  var previousFingerprint = previousEvent.fingerprint;\n\n  // If neither event has a fingerprint, they are assumed to be the same\n  if (!currentFingerprint && !previousFingerprint) {\n    return true;\n  }\n\n  // If only one event has a fingerprint, but not the other one, they are not the same\n  if (currentFingerprint && !previousFingerprint || !currentFingerprint && previousFingerprint) {\n    return false;\n  }\n  currentFingerprint = currentFingerprint;\n  previousFingerprint = previousFingerprint;\n\n  // Otherwise, compare the two\n  try {\n    return !!(currentFingerprint.join('') === previousFingerprint.join(''));\n  } catch (_oO) {\n    return false;\n  }\n}\n\n/** JSDoc */\nfunction _getExceptionFromEvent(event) {\n  return event.exception && event.exception.values && event.exception.values[0];\n}\n\n/** JSDoc */\nfunction _getFramesFromEvent(event) {\n  var exception = event.exception;\n  if (exception) {\n    try {\n      // @ts-ignore Object could be undefined\n      return exception.values[0].stacktrace.frames;\n    } catch (_oO) {\n      return undefined;\n    }\n  }\n  return undefined;\n}\nexport { Dedupe };","map":{"version":3,"names":["Dedupe","_classCallCheck","prototype","__init","call","_createClass","key","value","name","id","setupOnce","addGlobalEventProcessor","getCurrentHub","eventProcessor","currentEvent","type","self","getIntegration","_shouldDropEvent","_previousEvent","__SENTRY_DEBUG__","logger","warn","_oO","__initStatic","previousEvent","_isSameMessageEvent","_isSameExceptionEvent","currentMessage","message","previousMessage","_isSameFingerprint","_isSameStacktrace","previousException","_getExceptionFromEvent","currentException","currentFrames","_getFramesFromEvent","previousFrames","length","i","frameA","frameB","filename","lineno","colno","function","currentFingerprint","fingerprint","previousFingerprint","join","event","exception","values","stacktrace","frames","undefined"],"sources":["/Users/chirag_vaid/Desktop/Pesto/team-anil-rao-p8-team-anil-rao/node_modules/src/integrations/dedupe.ts"],"sourcesContent":["import type { Event, EventProcessor, Exception, Hub, Integration, StackFrame } from '@sentry/types';\nimport { logger } from '@sentry/utils';\n\n/** Deduplication filter */\nexport class Dedupe implements Integration {\n  /**\n   * @inheritDoc\n   */\n  public static id: string = 'Dedupe';\n\n  /**\n   * @inheritDoc\n   */\n  public name: string = Dedupe.id;\n\n  /**\n   * @inheritDoc\n   */\n  private _previousEvent?: Event;\n\n  /**\n   * @inheritDoc\n   */\n  public setupOnce(addGlobalEventProcessor: (callback: EventProcessor) => void, getCurrentHub: () => Hub): void {\n    const eventProcessor: EventProcessor = currentEvent => {\n      // We want to ignore any non-error type events, e.g. transactions or replays\n      // These should never be deduped, and also not be compared against as _previousEvent.\n      if (currentEvent.type) {\n        return currentEvent;\n      }\n\n      const self = getCurrentHub().getIntegration(Dedupe);\n      if (self) {\n        // Juuust in case something goes wrong\n        try {\n          if (_shouldDropEvent(currentEvent, self._previousEvent)) {\n            __DEBUG_BUILD__ && logger.warn('Event dropped due to being a duplicate of previously captured event.');\n            return null;\n          }\n        } catch (_oO) {\n          return (self._previousEvent = currentEvent);\n        }\n\n        return (self._previousEvent = currentEvent);\n      }\n      return currentEvent;\n    };\n\n    eventProcessor.id = this.name;\n    addGlobalEventProcessor(eventProcessor);\n  }\n}\n\n/** JSDoc */\nfunction _shouldDropEvent(currentEvent: Event, previousEvent?: Event): boolean {\n  if (!previousEvent) {\n    return false;\n  }\n\n  if (_isSameMessageEvent(currentEvent, previousEvent)) {\n    return true;\n  }\n\n  if (_isSameExceptionEvent(currentEvent, previousEvent)) {\n    return true;\n  }\n\n  return false;\n}\n\n/** JSDoc */\nfunction _isSameMessageEvent(currentEvent: Event, previousEvent: Event): boolean {\n  const currentMessage = currentEvent.message;\n  const previousMessage = previousEvent.message;\n\n  // If neither event has a message property, they were both exceptions, so bail out\n  if (!currentMessage && !previousMessage) {\n    return false;\n  }\n\n  // If only one event has a stacktrace, but not the other one, they are not the same\n  if ((currentMessage && !previousMessage) || (!currentMessage && previousMessage)) {\n    return false;\n  }\n\n  if (currentMessage !== previousMessage) {\n    return false;\n  }\n\n  if (!_isSameFingerprint(currentEvent, previousEvent)) {\n    return false;\n  }\n\n  if (!_isSameStacktrace(currentEvent, previousEvent)) {\n    return false;\n  }\n\n  return true;\n}\n\n/** JSDoc */\nfunction _isSameExceptionEvent(currentEvent: Event, previousEvent: Event): boolean {\n  const previousException = _getExceptionFromEvent(previousEvent);\n  const currentException = _getExceptionFromEvent(currentEvent);\n\n  if (!previousException || !currentException) {\n    return false;\n  }\n\n  if (previousException.type !== currentException.type || previousException.value !== currentException.value) {\n    return false;\n  }\n\n  if (!_isSameFingerprint(currentEvent, previousEvent)) {\n    return false;\n  }\n\n  if (!_isSameStacktrace(currentEvent, previousEvent)) {\n    return false;\n  }\n\n  return true;\n}\n\n/** JSDoc */\nfunction _isSameStacktrace(currentEvent: Event, previousEvent: Event): boolean {\n  let currentFrames = _getFramesFromEvent(currentEvent);\n  let previousFrames = _getFramesFromEvent(previousEvent);\n\n  // If neither event has a stacktrace, they are assumed to be the same\n  if (!currentFrames && !previousFrames) {\n    return true;\n  }\n\n  // If only one event has a stacktrace, but not the other one, they are not the same\n  if ((currentFrames && !previousFrames) || (!currentFrames && previousFrames)) {\n    return false;\n  }\n\n  currentFrames = currentFrames as StackFrame[];\n  previousFrames = previousFrames as StackFrame[];\n\n  // If number of frames differ, they are not the same\n  if (previousFrames.length !== currentFrames.length) {\n    return false;\n  }\n\n  // Otherwise, compare the two\n  for (let i = 0; i < previousFrames.length; i++) {\n    const frameA = previousFrames[i];\n    const frameB = currentFrames[i];\n\n    if (\n      frameA.filename !== frameB.filename ||\n      frameA.lineno !== frameB.lineno ||\n      frameA.colno !== frameB.colno ||\n      frameA.function !== frameB.function\n    ) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\n/** JSDoc */\nfunction _isSameFingerprint(currentEvent: Event, previousEvent: Event): boolean {\n  let currentFingerprint = currentEvent.fingerprint;\n  let previousFingerprint = previousEvent.fingerprint;\n\n  // If neither event has a fingerprint, they are assumed to be the same\n  if (!currentFingerprint && !previousFingerprint) {\n    return true;\n  }\n\n  // If only one event has a fingerprint, but not the other one, they are not the same\n  if ((currentFingerprint && !previousFingerprint) || (!currentFingerprint && previousFingerprint)) {\n    return false;\n  }\n\n  currentFingerprint = currentFingerprint as string[];\n  previousFingerprint = previousFingerprint as string[];\n\n  // Otherwise, compare the two\n  try {\n    return !!(currentFingerprint.join('') === previousFingerprint.join(''));\n  } catch (_oO) {\n    return false;\n  }\n}\n\n/** JSDoc */\nfunction _getExceptionFromEvent(event: Event): Exception | undefined {\n  return event.exception && event.exception.values && event.exception.values[0];\n}\n\n/** JSDoc */\nfunction _getFramesFromEvent(event: Event): StackFrame[] | undefined {\n  const exception = event.exception;\n\n  if (exception) {\n    try {\n      // @ts-ignore Object could be undefined\n      return exception.values[0].stacktrace.frames;\n    } catch (_oO) {\n      return undefined;\n    }\n  }\n  return undefined;\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}